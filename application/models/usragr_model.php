<?phpclass usragr_model extends CI_Model{    function __construct()    {        // Call the Model constructor        parent::__construct();        $this->load->database();    }    /*     * Create New Researcher     */    public function insert_researcher($data, $table)    {        // $sql = "INSERT INTO researcher(userName,emailId) VALUES ('$userName', '$emailId');";        $this->db->insert($table, $data);        if ($this->db->affected_rows() > 0) {            $userId = 'userId';            $maxval = $this->getmaxid($userId, $table);            return $maxval;        } else {            return $this->db->_error_message().print_r("");        }    }    /*     * Fetch the maximum value of the researcher     */    public function getmaxid($col, $table)    {        $this->db->select_max($col);        $query = $this->db->get($table);        foreach ($query->result() as $row) {            $maxval = $row->$col;        }        return $maxval;    }    /*     * Function insert the user request     */    public function insertUserRequest($data, $table)    {        $this->db->insert($table, $data);        if ($this->db->affected_rows() > 0) {            return 1;        } else {            return $this->db->_error_message() . print_r("");        }    }    /*     * Fetch the researcher with $userId     */    public function getresearcher($userId)    {        $sql = "SELECT * FROM researcher LEFT JOIN request ON researcher.userId = request.userId where researcher.userId = $userId ;";        $results = $this->db->query($sql, array($userId));        return $results->result();    }    /*     * Function to update researcher table     */    public function update_researcher($userName, $citystate, $address, $emailId, $zipCode, $comments, $date, $phoneNumber,$userInitials, $termsAndConditions,$userId)    {        $sql = "UPDATE researcher SET userName='$userName', citystate= '$citystate', address = '$address',                                 emailId ='$emailId',phoneNumber='$phoneNumber', zipCode='$zipCode', comments='$comments', date ='$date', userInitials = '$userInitials' ,termsAndCond ='$termsAndConditions'  WHERE userId='$userId' ;";        $this->db->query($sql);        if ($this->db->affected_rows() > 0) {            return 1;        } else {            // return 0;            return $this->db->_error_message() . print_r("");        }    }    /*     * Function to update researcher table     */    public function update_attachment($attachment,$userId)    {        $sql = "UPDATE researcher SET  attachment = '$attachment'  WHERE userId='$userId' ;";        $this->db->query($sql);        // $this->db->where('userId', "15");        //$this->db->update('researcher', $data);        if ($this->db->affected_rows() > 0) {            return 1;        } else {            // return 0;            return $this->db->_error_message() . print_r("");        }    }   /*    * Function to update researcher table    */    public function update_researcherWithStatus($userName, $citystate, $address, $emailId, $zipCode, $comments, $date, $phoneNumber,$status,$userInitials, $termsAndConditions,$userId)    {        $sql = "UPDATE researcher SET userName='$userName', citystate= '$citystate', address = '$address',                                 emailId ='$emailId',phoneNumber='$phoneNumber', zipCode='$zipCode', comments='$comments', date ='$date' , status= '$status' , userInitials = '$userInitials' ,termsAndCond ='$termsAndConditions' WHERE userId='$userId' ;";        $this->db->query($sql);        // $this->db->where('userId', "15");        //$this->db->update('researcher', $data);        if ($this->db->affected_rows() > 0) {            return 1;        } else {            // return 0;            return $this->db->_error_message() . print_r("");        }    }    /*     * Function to update researcher table     */    public function approveOrDisapprove_request($date,$status,$instructions,$userId)    {        $sql = "UPDATE researcher SET  date ='$date' , status= '$status', instructions = '$instructions' WHERE userId='$userId' ;";        $this->db->query($sql);        // $this->db->where('userId', "15");        //$this->db->update('researcher', $data);        if ($this->db->affected_rows() > 0) {            return 1;        } else {            // return 0;            return $this->db->_error_message() . print_r("");        }    }    /*     *  Insert the Use Agreement Information for user in request table     */    public function insertUseAgreementInformation($requestName, $requestDescription, $boxNumber, $itemNumber, $fileType, $imageResolution, $fileFormat, $audOrVidFileFormat, $userId)    {        $this->db->trans_start();        $this->db->query("INSERT INTO request(requestId,requestName,requestDescription,boxNumber,itemNumber,fileType,imageResolution,fileFormat,audOrVidFileFormat,userId) Values       (null,$requestName , $requestDescription , $boxNumber,$itemNumber ,$fileType,$imageResolution,$fileFormat,$audOrVidFileFormat,$userId );");        $this->db->trans_complete();        if ($this->db->affected_rows() > 0) {            return 1;        } else {            return 0;        }    }     /*      * Function to delete the requests.      */    public function deleteRequests($userId)    {        $this ->db ->trans_start();        $this -> db -> where('userId', $userId);        $result= $this -> db -> delete('request');        // $sql = "DELETE FROM request WHERE userId= '$userId'";        //delete existing requests        //  $result =  $this->db->query($sql);        if($result>0){            $this->db->trans_complete();        }        else{            $this->db->trans_rollback();        }        return $result;    }}?>